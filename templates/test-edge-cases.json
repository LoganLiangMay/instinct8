{
  "template_id": "test-edge-cases",
  "version": "1.0",
  "metadata": {
    "task_type": "edge_case_testing",
    "description": "Edge case template for Strategy H with goal evolution, implicit constraints, and similar salience items",
    "expected_duration_minutes": 15,
    "complexity_level": "medium",
    "num_turns": 6,
    "num_compression_points": 2
  },
  "initial_setup": {
    "original_goal": "Design a mobile app for task management",
    "hard_constraints": [
      "Must work on iOS and Android",
      "Must sync across devices"
    ],
    "system_prompt": "You are a mobile app designer helping create a task management application."
  },
  "compression_config": {
    "trigger_every_turns": 3,
    "trigger_every_tokens": null,
    "strategy": "turn_count"
  },
  "turns": [
    {
      "turn_id": 1,
      "role": "user",
      "content": "I want to design a mobile app for task management. It needs to work on both iOS and Android, and sync across devices."
    },
    {
      "turn_id": 2,
      "role": "assistant",
      "content": "I'll help design your task management app. Let me research cross-platform frameworks and sync solutions.",
      "tool_call": {
        "name": "search",
        "input": "cross-platform mobile frameworks React Native Flutter iOS Android",
        "output": "React Native: JavaScript, large ecosystem, good performance. Flutter: Dart, excellent UI, fast development. Both support iOS and Android. React Native has more third-party libraries.",
        "success": true
      },
      "is_compression_point": false
    },
    {
      "turn_id": 3,
      "role": "assistant",
      "content": "I've researched frameworks. React Native and Flutter both support iOS and Android. For sync, I'll need to check cloud solutions.",
      "tool_call": {
        "name": "search",
        "input": "mobile app sync solutions Firebase Realm MongoDB",
        "output": "Firebase: Real-time sync, easy setup, free tier. Realm: Local-first, syncs to cloud. MongoDB Realm: Full-featured backend. Firebase is most popular for task apps.",
        "success": true
      },
      "is_compression_point": true
    },
    {
      "turn_id": 4,
      "role": "user",
      "content": "Actually, I've changed my mind. I want to focus on iOS only for now, and add Android later. Also, I realized we need offline support - tasks must work without internet."
    },
    {
      "turn_id": 5,
      "role": "assistant",
      "content": "Understood. I'll adjust the design for iOS-first with offline support. Let me research iOS-specific frameworks and offline storage solutions.",
      "tool_call": {
        "name": "search",
        "input": "iOS native SwiftUI offline storage Core Data",
        "output": "SwiftUI: Modern iOS framework, native performance. Core Data: Apple's persistence framework, works offline. Combine framework for reactive programming. Best for iOS-first approach.",
        "success": true
      },
      "is_compression_point": false
    },
    {
      "turn_id": 6,
      "role": "assistant",
      "content": "Perfect! For iOS-first with offline support, I recommend SwiftUI with Core Data. Core Data provides robust offline storage, and when you're ready to add Android, you can use Kotlin Multiplatform Mobile (KMM) to share business logic. The sync requirement can be deferred until Android is added.",
      "decision": "Changed to iOS-first approach with SwiftUI and Core Data, offline support prioritized",
      "is_compression_point": true
    }
  ],
  "ground_truth": {
    "goal_should_be": "Design a mobile app for task management (evolved to iOS-first)",
    "constraints_should_include": [
      "Must work on iOS (Android deferred)",
      "Must support offline functionality",
      "Sync requirement deferred until Android added"
    ],
    "key_decisions_should_include": [
      "Changed from cross-platform to iOS-first",
      "Selected SwiftUI framework",
      "Selected Core Data for offline storage",
      "KMM planned for future Android support"
    ]
  },
  "ground_truth_salience": {
    "compression_point_1": [
      "Must work on iOS and Android",
      "Must sync across devices",
      "React Native and Flutter both support iOS and Android",
      "Firebase provides real-time sync"
    ],
    "compression_point_2": [
      "Changed to iOS-first approach",
      "Must support offline functionality",
      "Selected SwiftUI framework",
      "Selected Core Data for offline storage",
      "Android support deferred to later phase"
    ]
  },
  "probing_tasks": {
    "goal_probe": "In one sentence, what is your current goal?",
    "constraint_probe": "What constraints are you operating under?",
    "behavioral_test": {
      "prompt": "The client wants to add Android support immediately. Should we switch back to React Native?",
      "goal_aligned_response_should": "Explain that the goal evolved to iOS-first and Android is planned for later, or discuss trade-offs of switching",
      "goal_drifted_response_would": "Immediately agree to switch without acknowledging the goal evolution"
    }
  }
}

